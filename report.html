<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Report &mdash; UMBC Data 606 Capstone: Real Time Arbitrage Bot 0.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="_static/umbc_logo.jpg"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="User Guide" href="user_guide.html" />
    <link rel="prev" title="UMBC Data 606 Capstone: Real Time Arbitrage Bot" href="getting_started.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html">
            <img src="_static/umbc_logo.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">UMBC Data 606 Capstone: Real Time Arbitrage Bot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#documentation">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#authors">Authors</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#disclosure">Disclosure</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#support">Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#todo">TODO</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Report</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#abstract">Abstract</a></li>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-is-a-crypto-trading-arbitrage-bot">What is a Crypto Trading/Arbitrage Bot?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameters-of-our-triangular-arbitrage-bot">Parameters of Our Triangular Arbitrage Bot</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#dataset">Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-does-our-bot-work">How does our bot work?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#live-py">Live.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="#account-py">Account.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="#analysis-py">Analysis.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="#trade-py">Trade.py</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-flow-for-this-project">Data Flow for This Project</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#price-prediction-with-time-series-analysis">Price Prediction with Time Series Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bellman-ford-algorithm">Bellman-Ford Algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#comparing-the-results-of-the-models">Comparing the Results of the Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="#conclusion">Conclusion</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="user_guide.html">User Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="live.html">Live</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="analysis.html">Analysis</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="account.html">Account</a><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="trade.html">Trade</a><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">UMBC Data 606 Capstone: Real Time Arbitrage Bot</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Report</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="report">
<h1>Report<a class="headerlink" href="#report" title="Permalink to this headline"></a></h1>
<section id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline"></a></h2>
<p>The purpose of this study is to create a crypto arbitrage bot which allows users to execute automated trades. Triangular arbitrage is chosen as the arbitrage method, so the aim is to take advantage of the price differences between three different pairs. Kucoin, and Gemini are chosen exchanges for this project. The Bellman-Ford algorithm is used for decision making which computes the shortest path in a single source vortex. Other than triangular arbitrage, price prediction is done in this project for different coins’ prices by using Sarimax, Autorima, and Nbeat models.</p>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline"></a></h2>
<p>Arbirtrage is buying an asset on an exchange and selling it at another exchange for a higher price. It is a very straightforward process for traders. When a stock’s price is lower on a foreign exchange, they buy it from there and sell it on the local exchange. The price on the foreign exchange is considered as “undervalued” because there are delays in adjusting the prices on different exchanges. However, detecting arbitrage opportunities is a very hard work, taking advantage of them is even harder. Trading arbitrage opportunities manually is almost impossible because they occur and dissappear in seconds. For that reason, it requires advanced programs and computer equipments to automate this process. There are already numerous programs in every exchange which tries to take advantage from these discrepancies. There are different types of arbitrages like pure arbitrage, merger arbitrage, triangular arbitrage, etc. In this project, triangular arbitrage is studied and applied in crypto market. If a disparity between three foreign currencies happens when their exchange rates do not exactly line up, resulting in triangular arbitrage. In other words, triangular arbitrage exploits market inefficiencies, and help market to become efficient. Below example shows how the triangular arbitrage works between the fiat currencies EUR, USD, and GBP.</p>
<p>Example for triangular arbitrage:
<em>Suppose you have $1 million, and you are provided with the following exchange rates: EUR/USD = 1.1586, EUR/GBP = 1.4600, and USD/GBP = 1.6939. With these exchange rates there is an arbitrage opportunity:</em>
<em>Sell dollars to buy euros: $1 million ÷ 1.1586 = €863,110</em>
<em>Sell euros for pounds: €863,100 ÷ 1.4600 = £591,171</em>
<em>Sell pounds for dollars: £591,171 x 1.6939 = $1,001,384</em>
<em>Subtract the initial investment from the final amount: $1,001,384 – $1,000,000 = $1,384</em>
<em>From these transactions, you would receive an arbitrage profit of $1,384 (assuming no transaction costs or taxes).</em>
<em>(Source: <a class="reference external" href="https://www.investopedia.com/terms/t/triangulararbitrage.asp">https://www.investopedia.com/terms/t/triangulararbitrage.asp</a>)</em></p>
<p>Triangular arbitrage is widely studied before from different aspects mostly in foreign exchange trading platforms. People practice triangular arbitrage between fiat currencies like the example above. While the analysis of Aloosh and Bekaert (2017) aims at controlling for the triangular arbitrage, our project tries to charactrize and take advantage from arbitrage opportunities. Another research from Piccotti (2018) uses 5-minute period in his quote revisions, while our project tries to detect arbitrage opportunities in miliseconds. Speed is important while trading arbitrage, but in crypto world it is even more essential. The crypto market’s volatility is extremely higher than foreign exchange market, thus working with shorter time intervals is necessary. Another constraint to trade arbitrage opportunities is their decreasing number over the years. According to the examination of time series data from 1999 to 2009, it is found that there is a decrease in the number of triangle arbitrage possibilities (Ito, 2012). This is expected and can be normalized because the market becomes more efficient over the years with the advancement of the technology. However, it is never perfect, so there is still room for users to take advantage from discrepencies.</p>
<p>There has been much other research about market discrepancies and arbitrage trading. Different methods and various types of models have been used to trade arbitrage opportunities. Gebarowski et al. (2019) aimed to show the prediction power of q-detrended cross-correlation coefficient stemming when it is practiced over historical time series of exchange rates for certain currencies in their research. They investigated how financial markets create arbitrage opportunities by analyzing the delicacy of different statistical properties. Another study from Lin et al. (2011) analyzed cross-correlations in the stock exchange via using time-delay variant of DCCA (detrended cross-correlation analysis) method.</p>
<p>In research from Gradojevic et al. (2020) it is found that high frequency traders’ movements are supported by triangle arbitrage, which occurs in a milisecond trading environment. In their study, they used wavelet-based regression approach that allowed them to find 80-100 arbitrage opportunities in a day in Foreign Exchange (FX). Expectedly, these aberrations are brief, lasting between 100 and 500 milliseconds. The average profit ranged between 0.5 and 0.75 basis points. However, as mentioned earlier the volatility in the cryptocurrency market is higher. In our model, we were able to detect 3 different arbitrage opportunities in a minute. When we ran our model, we observed … arbitrage opportunities which have a higher profit rate than 0.1%. The same study from Gradojevic et al. (2020) suggests that currencies with low cross-correlation with others tends to have higher profit rates in arbitrage opportunities. Another research from Knif et al. (1995) uses frequency-embedded spectral approach to investigate the connection between two European stock exchanges. They found that the market dependence can be described in a manageable way by using multiscale resolution of stock market performance and volatility.</p>
<section id="what-is-a-crypto-trading-arbitrage-bot">
<h3>What is a Crypto Trading/Arbitrage Bot?<a class="headerlink" href="#what-is-a-crypto-trading-arbitrage-bot" title="Permalink to this headline"></a></h3>
<p>Automated trading started in 1980s. It has been used and developed since then by institutional investors and large trading firms for different purposes. It is also known as algorithmic trading by investors. Nowadays algorithmic trading composes 60-70% of the total equity trades in the US market. It is 100% legal, and very preferable by users due to its ability for high frequency trading. The investors are able to trade 7/24 with the help of these computer programs without spending days and nights on their computers. Once they setup their parameters, the program is ready to execute trades on selected currencies. The first product invented for this purpose was Automated Trading Desk (ATD). MacKenzie (2016) explains that ATDs were primarily automated marketmakers in his research. They were invented to replace NYSE specialists whose role is to buy an asset from a given price and sell it for a higher price. Nevertheless, relying on people makes this process slow, and it is very fragile against human mistakes. While ATDs make this process a lot faster and better, they are not considered as the official marketmakers.</p>
<p>Trading bots can be considered a type of ATDs. They are computer programs that are programmed to automatically execute buy and sell orders on an exchange based on a trading strategy. There are various service providers on the market not just for trading but for arbitrage trading too. Users can either choose an in-built trading strategy or make their own with their favorite indicators and currency pairs. Arbitrage bots have the same concept as the trading bots, but their strategy is based on making profit from price discrepencies. <em>?For example, Pionex is a crypto trading bot provider which also offers arbitrage bot. Their system is based on opening a hedge position in perpetual futures market on people’s spot crypto positions. If a client has $1000 invested Ethereum (ETH) in spot, the bot opens a short position worth of $1000 on ETH-USDT pair. Since long position holders pay a funding fee to short position holders in every 8 hours, their earnings and losses balances each other but the earnings from funding fee is their profit. If the investors hold short positions more than the long positions, this strategy will not work. However, the funding rate (a ratio shows the balance between the long and short positions) is mostly positive, this strategy can make money to the investors especially in bullish market cycles.?</em></p>
<p>Triangular arbitrage bots are slightly different than regular arbitrage bots because of the concept of triangular arbitrage. Rather than trading an asset in different exchanges, triangular arbitrage focuses on the selected three currencies and trades them in the same exchange. Multiple opportunities are created in crypto market for triangular arbitrage trading. Due to its high volatility and non-stop market structure, crypto currency market is a gem for most traders.</p>
<p>Triangular arbitrage works in the same logic as in foreign exchange market. It exploits from the market inefficiencies in crypto market. Below example explains how it works:</p>
<p><img alt="Triangular Arbitrage" src="_images/triangular.jpg" /></p>
</section>
<section id="parameters-of-our-triangular-arbitrage-bot">
<h3>Parameters of Our Triangular Arbitrage Bot<a class="headerlink" href="#parameters-of-our-triangular-arbitrage-bot" title="Permalink to this headline"></a></h3>
<p>In this study, Kucoin exchange is used for analysis. Necessary API keys are generated to gather all the coins’ prices in Kucoin. At first, the coin prices were gathered for 5 minutes, and the analysis were made in this dataset. Taker, and maker fees are adjusted to 0.001 according to real fees applied in Kucoin. Fiat unit per trade is adjusted to 50 US Dollars. To avoid small profit margins, minimum percentage of profit margin to display is adjusted to 0.1%. This adjustment was necessary because smaller profit margins get eaten by trading fees, and this can cause the trader to lose money on trades. For that reason, any trade opportunity needs to have at least 0.1% to be executed. The model also calculates two different arbitrage opportunities for given three currencies. These are defined as forward arbitrage, and reverse arbitrage. The model executes the arbitrage opportunity with higher profit margin with the constraint of being more than 0.1%.</p>
</section>
</section>
<section id="dataset">
<h2>Dataset<a class="headerlink" href="#dataset" title="Permalink to this headline"></a></h2>
<p>Kucoin
Historical Data - Exploratory data analysis
Analysis.py - Live data</p>
</section>
<section id="how-does-our-bot-work">
<h2>How does our bot work?<a class="headerlink" href="#how-does-our-bot-work" title="Permalink to this headline"></a></h2>
<p>In this model there are multiple notebooks generated for different purposes. In this section, we will dive into these notebooks and explain how they work.</p>
<section id="live-py">
<h3>Live.py<a class="headerlink" href="#live-py" title="Permalink to this headline"></a></h3>
<p>Firstly, configuration yaml is loaded and dictionary of setting is returned in this notebook. Then, log files are created with the date stamp added on each file name to clarify them for users. Kucoin API keys are entered here for data collection. After that, the real time coin price data are collected and saved in these log files. The data collected is also used to create tables. In these tables there is information about the coin’s best ask price, best bid price, best ask size, date stamp, etc. Below image is an example for these tables.</p>
<p><img alt="kucoin.tickers" src="_images/tickers.png" /></p>
</section>
<section id="account-py">
<h3>Account.py<a class="headerlink" href="#account-py" title="Permalink to this headline"></a></h3>
<p>This notebook monitors spot trades. Each and every change in account balance is displayed to have full knowledge on account balance. The changes and trades are stored in a database.</p>
</section>
<section id="analysis-py">
<h3>Analysis.py<a class="headerlink" href="#analysis-py" title="Permalink to this headline"></a></h3>
<p>Trade opportunities are filtered depending on their profit rates in this notebook. The pairs are scanned in milliseconds for both forward and reverse trading opportunities. Trade opportunities with 0.1% or greater are going to be executed. Base ticker, quote ticker, best bid price, best ask price, best ask size, best bid size, price, sequence, size, and time columns of each opportunity are displayed. The trade opportunities which satisfy the constraints are executed in trade.py. <em>?This notebook includes both opportunities from triangular arbitrage, and bellman-ford optimization.?</em></p>
</section>
<section id="trade-py">
<h3>Trade.py<a class="headerlink" href="#trade-py" title="Permalink to this headline"></a></h3>
<p>The opportunities detected in analysis.py are executed in this notebook. Trade opportunity with the greater profit rate between forward and reverse arbitrage is executed. If the profit rate is the same, forward arbitrage is executed. After every execution there is a print command “attempted” to continue processing next trade. Even if the opportunity is not executed, there is a print command “attempted”. Since the books have already changed, this action is neccessary to avoid losses, and leave that last trade behind.</p>
</section>
<section id="data-flow-for-this-project">
<h3>Data Flow for This Project<a class="headerlink" href="#data-flow-for-this-project" title="Permalink to this headline"></a></h3>
<p><img alt="Data Flow Diagram" src="_images/dataflow.png" /></p>
</section>
</section>
<section id="price-prediction-with-time-series-analysis">
<h2>Price Prediction with Time Series Analysis<a class="headerlink" href="#price-prediction-with-time-series-analysis" title="Permalink to this headline"></a></h2>
<p>Sarima
Arima
NBeat</p>
</section>
<section id="bellman-ford-algorithm">
<h2>Bellman-Ford Algorithm<a class="headerlink" href="#bellman-ford-algorithm" title="Permalink to this headline"></a></h2>
<p>Analysis
Results</p>
<p><img alt="Bellman Ford Graph" src="_images/graph.png" /></p>
</section>
<section id="comparing-the-results-of-the-models">
<h2>Comparing the Results of the Models<a class="headerlink" href="#comparing-the-results-of-the-models" title="Permalink to this headline"></a></h2>
<p>Triangular Arbitrage Bot vs. Bellman-Ford</p>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline"></a></h2>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline"></a></h2>
<p>Aloosh, A., &amp; Bekaert, G. (2017). Currency Factors. SSRN Electronic Journal. <a class="reference external" href="https://doi.org/10.2139/ssrn.3022623">https://doi.org/10.2139/ssrn.3022623</a></p>
<p>Gębarowski, R., Oświęcimka, P., Wątorek, M., &amp; Drożdż, S. (2019). Detecting correlations and triangular arbitrage opportunities in the Forex by means of multifractal detrended cross-correlations analysis. Nonlinear Dynamics, 98(3), 2349–2364. <a class="reference external" href="https://doi.org/10.1007/s11071-019-05335-5">https://doi.org/10.1007/s11071-019-05335-5</a></p>
<p>Gradojevic, N., Erdemlioglu, D., &amp; Gençay, R. (2020). A new wavelet-based ultra-high-frequency analysis of triangular currency arbitrage. Economic Modelling, 85, 57–73. <a class="reference external" href="https://doi.org/10.1016/j.econmod.2019.05.006">https://doi.org/10.1016/j.econmod.2019.05.006</a></p>
<p>Ito, T. (2012, November 15). Free Lunch! Arbitrage Opportunities in the Foreign Exchange Markets. NBER. <a class="reference external" href="https://www.nber.org/papers/w18541">https://www.nber.org/papers/w18541</a></p>
<p>Knif, J., Pynnönen, S., &amp; Luoma, M. (1995). An analysis of lead-lag structures using a frequency domain approach: Empirical evidence from the Finnish and Swedish stock markets. European Journal of Operational Research, 81(2), 259–270. <a class="reference external" href="https://doi.org/10.1016/0377-2217(93)e0321-n">https://doi.org/10.1016/0377-2217(93)e0321-n</a></p>
<p>Lin, A., Shang, P., &amp; Zhao, X. (2011). The cross-correlations of stock markets based on DCCA and time-delay DCCA. Nonlinear Dynamics, 67(1), 425–435. <a class="reference external" href="https://doi.org/10.1007/s11071-011-9991-8">https://doi.org/10.1007/s11071-011-9991-8</a></p>
<p>MacKenzie, D. (2016). A material political economy: Automated Trading Desk and price prediction in high-frequency trading. Social Studies of Science, 47(2), 172–194. <a class="reference external" href="https://doi.org/10.1177/0306312716676900">https://doi.org/10.1177/0306312716676900</a></p>
<p>Piccotti, L. R. (2018). Jumps, cojumps, and efficiency in the spot foreign exchange market. Journal of Banking &amp; Finance, 87, 49–67. <a class="reference external" href="https://doi.org/10.1016/j.jbankfin.2017.09.007">https://doi.org/10.1016/j.jbankfin.2017.09.007</a></p>
<p>A new wavelet-based ultra-high-frequency analysis of triangular currency arbitrage
Detecting correlations and triangular arbitrage opportunities in the Forex by means of multifractal detrended cross-correlations analysis <a class="reference external" href="https://www.geeksforgeeks.org/bellman-ford-algorithm-dp-23/">https://www.geeksforgeeks.org/bellman-ford-algorithm-dp-23/</a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="getting_started.html" class="btn btn-neutral float-left" title="UMBC Data 606 Capstone: Real Time Arbitrage Bot" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="user_guide.html" class="btn btn-neutral float-right" title="User Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022 Erick Garcia, Daniel Abbasi, Yuksel Baris Dokuzoglu. All rights reserved..</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>